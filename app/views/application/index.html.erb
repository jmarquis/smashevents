<h1>Smash Events</h1>

<nav>
  <form method="get" action="/">
    <label>
      <div><input type="checkbox" name="melee" value="1" <%= 'checked' if @melee %> onchange="this.form.submit()"><span></span></div>Melee
    </label>
    <label>
      <div><input type="checkbox" name="ultimate" value="1" <%= 'checked' if @ultimate %> onchange="this.form.submit()"><span></span></div>Ultimate
    </label>
  </form>
</nav>

<main>

  <% @tournaments.each do |tournament| %>
    <article>
      <time><%= date_range(tournament) %></time>
      <h2><a href="https://start.gg/<%= tournament.slug %>" target="_blank"><%= tournament.name %></a></h2>
      <div><%= tournament.city %>, <%= tournament.state %><%= ", #{tournament.country}" unless tournament.country.in? ['US', 'GB'] %></div>

      <% @games.each do |game| %>
        <% event = tournament.events.find_by(game: game[:slug]) %>
        <% if event.present? && event.player_count.present? && event.player_count > 0 %>
          <div class="game">
            <p><%= "#{game[:name]}: " if @games.count > 1 %><%= event.player_count.round(-1) %>+ players</p>
            <ul class="players">
              <% if event.featured_players.present? %>
                <% event.featured_players.each do |player| %>
                  <li><%= player %></li>
                <% end %>
              <% else %>
                <li>Featured players coming soon.</li>
              <% end %>
            </ul>
          </div>
        <% end %>
      <% end %>

    </article>
  <% end %>

</main>

<footer>
  Made with â™¥ by <a href="https://twitter.com/mathssbm" target="_blank">Math</a> | Powered by <a href="https://start.gg" target="_blank">start.gg</a>
</footer>
